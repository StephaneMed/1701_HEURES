<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=0.8">
  <title>1701_HEURES</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
  <style>
    /* Mode sombre compact et centr√© */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #121212; /* Fond sombre uniforme */
      color: #e0e0e0;
    }

    h1 {
      font-size: 1.6em;
      color: #ffffff;
      text-align: center;
      margin: 1px 0;
      text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.6);
    }

    .main-container {
      width: 90%;
      max-width: 400px;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #1c1c1c; /* Fond l√©g√®rement plus clair */
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
    }

/* S√©lection de la date */
    .calendar-container {
      width: 100%;
      display: flex; /*  Permet d'aligner le texte et le s√©lecteur  */
      align-items: center; /*  Aligne verticalement les √©l√©ments  */
      margin: 8px 0;
      padding: 10px;
      background-color: #2b2b2b;
      border-radius: 6px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
    }
    .calendar-container h3 {
      font-size: 1.2em;
      color: #ffffff;
      text-transform: uppercase;
      border-bottom: 2px solid #87CEFA;
      padding-bottom: 6px;
      margin: 0; /*  Supprime les marges par d√©faut  */
      margin-right: 10px; /*  Ajoute une marge √† droite  */
    }
    .calendar-container input {
      width: auto; /*  Le s√©lecteur prend la largeur n√©cessaire  */
      padding: 8px;
      background-color: #333;
      color: #e0e0e0;
      border: 1px solid #555;
      border-radius: 5px;
      font-size: 1em;
      transition: border-color 0.3s ease;
    }
    .calendar-container input:focus {
      border-color: #87CEFA;
      outline: none;
    }

    /* Conteneur de chaque t√¢che */
    .task-container {
      width: 100%;
      margin: 2px 0;
      padding: 10px;
      background-color: #2b2b2b;
      border-radius: 6px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
    }
    .required-task {
      background-color: #3a3a3a; /* Fond pour les t√¢ches requises */
    }
    .task-container h3 {
      font-size: 1.2em;
      margin-top: 4px; /*  Marge sup√©rieure r√©duite  */
      margin-bottom: 4px;
      color: #ffffff;
      text-align: center;
      text-transform: uppercase;
      border-bottom: 2px solid #87CEFA;
      padding-bottom: 3px;
    }

    /* Champs de saisie et boutons align√©s */
    .flex-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    button, input[type="text"] {
      width: 30%;
      padding: 8px;
      font-size: 1em;
      color: #0c0c0c;
      border-radius: 6px;
      border: none;
      text-align: center;
      transition: transform 0.2s, background-color 0.3s ease;
    }
    input[type="text"] {
      background-color: #333;
      color: #e0e0e0;
      border: 1px solid #555;
    }
    input[type="text"]:focus {
      border-color: #87CEFA;
      outline: none;
    }
    button {
      cursor: pointer;
      font-weight: bold;
      color: #ffffff;
    }
    button:hover {
      transform: translateY(-2px);
    }
    .time-button {
      background-color: #87CEFA;
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
    }
    .zero-button {
      background-color: #d9534f;
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
    }
    .calculate-button {
      background-color: #1e90ff;
    }
    .save-button {
      background-color: #4caf50;
    }
    .clear-button {
      background-color: #d9534f;
    }

    /* Conteneur des r√©sultats */
    .results-container {
      width: 100%;
      padding: 5px;
      background-color: #3a3a3a;
      border-radius: 6px;
      margin-top: 10px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
    }
    .results-container h3 {
      font-size: 1.1em;
      margin-bottom: 6px;
      color: #ffffff;
    }
    .result-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1em;
      padding: 5px;
      margin: 6px 6px;
      background-color: #2b2b2b;
      border-radius: 5px;
      color: #e0e0e0;
    }
    .result-item span {
      font-weight: bold;
      color: #87CEFA;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
</head>
<body>
<div class="main-container">
  <!-- S√©lection du jour -->
  <div class="calendar-container">
    <h3>DATE DU JOUR:</h3> <input type="date" id="selectedDate" onchange="loadDataForDate()">
  </div>

  <!-- Bureau matin -->
  <div class="task-container">
    <h3>Bureau matin</h3>
    <div class="flex-container">
      <button class="time-button" onclick="setCurrentTime('bureauMatinStartTime')">D√©but</button>
      <input type="text" id="bureauMatinStartTime" placeholder="hh:mm">
      <button class="time-button" onclick="setCurrentTime('bureauMatinStopTime')">Fin</button>
      <input type="text" id="bureauMatinStopTime" placeholder="hh:mm">
      <button class="zero-button" onclick="setZeroTime('bureauMatinStartTime', 'bureauMatinStopTime')">Zero</button>
    </div>
  </div>

  <!-- Trajet matin -->
  <div class="task-container required-task">
    <h3>Premier Trajet matin (Requis)</h3>
    <div class="flex-container">
      <button class="time-button" onclick="setCurrentTime('trajetMatinStartTime')">D√©but</button>
      <input type="text" id="trajetMatinStartTime" placeholder="hh:mm">
      <button class="time-button" onclick="setCurrentTime('trajetMatinStopTime')">Fin</button>
      <input type="text" id="trajetMatinStopTime" placeholder="hh:mm">
      <button class="zero-button" onclick="setZeroTime('trajetMatinStartTime', 'trajetMatinStopTime')">Zero</button>
    </div>
  </div>

  <!-- Pause midi -->
  <div class="task-container">
    <h3>Pause midi</h3>
    <div class="flex-container">
      <button class="time-button" onclick="setCurrentTime('pauseMidiStartTime')">D√©but</button>
      <input type="text" id="pauseMidiStartTime" placeholder="hh:mm">
      <button class="time-button" onclick="setCurrentTime('pauseMidiStopTime')">Fin</button>
      <input type="text" id="pauseMidiStopTime" placeholder="hh:mm">
      <button class="zero-button" onclick="setZeroTime('pauseMidiStartTime', 'pauseMidiStopTime')">Zero</button>
    </div>
  </div>

  <!-- Trajet soir -->
  <div class="task-container required-task">
    <h3>Dernier Trajet soir (Requis)</h3>
    <div class="flex-container">
      <button class="time-button" onclick="setCurrentTime('trajetSoirStartTime')">D√©but</button>
      <input type="text" id="trajetSoirStartTime" placeholder="hh:mm">
      <button class="time-button" onclick="setCurrentTime('trajetSoirStopTime')">Fin</button>
      <input type="text" id="trajetSoirStopTime" placeholder="hh:mm">
      <button class="zero-button" onclick="setZeroTime('trajetSoirStartTime', 'trajetSoirStopTime')">Zero</button>
    </div>
  </div>

  <!-- Bureau soir -->
  <div class="task-container">
    <h3>Bureau soir</h3>
    <div class="flex-container">
      <button class="time-button" onclick="setCurrentTime('bureauSoirStartTime')">D√©but</button>
      <input type="text" id="bureauSoirStartTime" placeholder="hh:mm">
      <button class="time-button" onclick="setCurrentTime('bureauSoirStopTime')">Fin</button>
      <input type="text" id="bureauSoirStopTime" placeholder="hh:mm">
      <button class="zero-button" onclick="setZeroTime('bureauSoirStartTime', 'bureauSoirStopTime')">Zero</button>
    </div>
  </div>

  <!-- Conteneur de r√©sultats -->
  <div class="results-container" id="resultsContainer">
    <button class="calculate-button" onclick="displayResults()">Calculer</button>
    <button class="save-button" onclick="saveDataForDate()">Sauver</button>
    <button class="clear-button" onclick="clearInputs()">Effacer</button>

    <div class="result-item" id="resultTrajetMatin">
      <div class="result-text"><i class="result-icon">üöó</i> Trajet matin (A Saisir):</div>
      <span>-</span>
    </div>
    <div class="result-item" id="resultTrajetSoir">
      <div class="result-text"><i class="result-icon">üöó</i> Trajet soir (A Saisir):</div>
      <span>-</span>
    </div>
    <div class="result-item" id="resultTempsTravail">
      <div class="result-text"><i class="result-icon">üíº</i> Temps Travail (A Saisir):</div>
      <span>-</span>
    </div>
  </div>

  <!-- Script JavaScript pour g√©rer le chronom√®tre, le stockage et la date -->
  <script>
    function parseTimeToMinutes(time) {
      if (!time) return 0;
      const [hours, minutes] = time.split(":").map(Number);
      return hours * 60 + minutes;
    }

    function calculateElapsed(start, stop) {
      const startMinutes = parseTimeToMinutes(start);
      const stopMinutes = parseTimeToMinutes(stop);
      return stopMinutes >= startMinutes
        ? stopMinutes - startMinutes
        : stopMinutes - startMinutes + 1440;
    }

    function displayResults() {
      const trajetMatin = calculateElapsed(
        document.getElementById("trajetMatinStartTime").value,
        document.getElementById("trajetMatinStopTime").value
      );
      const trajetSoir = calculateElapsed(
        document.getElementById("trajetSoirStartTime").value,
        document.getElementById("trajetSoirStopTime").value
      );
      const bureauMatin = calculateElapsed(
        document.getElementById("bureauMatinStartTime").value,
        document.getElementById("bureauMatinStopTime").value
      );
      const bureauSoir = calculateElapsed(
        document.getElementById("bureauSoirStartTime").value,
        document.getElementById("bureauSoirStopTime").value
      );
      const pauseMidi = calculateElapsed(
        document.getElementById("pauseMidiStartTime").value,
        document.getElementById("pauseMidiStopTime").value
      );

      const intervalTrajetMatinSoir = calculateElapsed(
        document.getElementById("trajetMatinStopTime").value,
        document.getElementById("trajetSoirStartTime").value
      );

      const travailTotal = bureauMatin + bureauSoir - pauseMidi + intervalTrajetMatinSoir;

      document.getElementById("resultTrajetMatin").querySelector("span").textContent =
        `${Math.floor(trajetMatin / 60)}h${trajetMatin % 60}m`;
      document.getElementById("resultTrajetSoir").querySelector("span").textContent =
        `${Math.floor(trajetSoir / 60)}h${trajetSoir % 60}m`;
      document.getElementById("resultTempsTravail").querySelector("span").textContent =
        `${Math.floor(travailTotal / 60)}h${travailTotal % 60}m`;
    }

    function setCurrentTime(inputId) {
      const now = new Date();
      const formattedTime = now.toLocaleTimeString("fr-FR", {
        hour: "2-digit",
        minute: "2-digit",
      });
      document.getElementById(inputId).value = formattedTime;
    }

    function clearInputs() {
      document.querySelectorAll("input[type='text']").forEach((input) => (input.value = ""));
      document.querySelectorAll(".result-item span").forEach((span) => (span.textContent = "-"));
    }

    function setZeroTime(startId, endId) {
      document.getElementById(startId).value = "00:00";
      document.getElementById(endId).value = "00:00";
    }

    function saveDataForDate() {
      const selectedDate = document.getElementById("selectedDate").value;
      if (!selectedDate) {
        alert("Veuillez s√©lectionner une date pour sauvegarder les donn√©es.");
        return;
      }

      const data = {
        bureauMatinStart: document.getElementById("bureauMatinStartTime").value,
        bureauMatinStop: document.getElementById("bureauMatinStopTime").value,
        trajetMatinStart: document.getElementById("trajetMatinStartTime").value,
        trajetMatinStop: document.getElementById("trajetMatinStopTime").value,
        pauseMidiStart: document.getElementById("pauseMidiStartTime").value,
        pauseMidiStop: document.getElementById("pauseMidiStopTime").value,
        trajetSoirStart: document.getElementById("trajetSoirStartTime").value,
        trajetSoirStop: document.getElementById("trajetSoirStopTime").value,
        bureauSoirStart: document.getElementById("bureauSoirStartTime").value,
        bureauSoirStop: document.getElementById("bureauSoirStopTime").value,
        resultTrajetMatin: document.getElementById("resultTrajetMatin").querySelector("span").textContent,
        resultTrajetSoir: document.getElementById("resultTrajetSoir").querySelector("span").textContent,
        resultTempsTravail: document.getElementById("resultTempsTravail").querySelector("span").textContent,
      };

      localStorage.setItem(`data-${selectedDate}`, JSON.stringify(data));
      alert("Donn√©es sauvegard√©es pour la date s√©lectionn√©e.");
    }

    function loadDataForDate() {
      const selectedDate = document.getElementById("selectedDate").value;
      if (!selectedDate) return;

      const data = JSON.parse(localStorage.getItem(`data-${selectedDate}`));
      if (data) {
        document.getElementById("bureauMatinStartTime").value = data.bureauMatinStart || "";
        document.getElementById("bureauMatinStopTime").value = data.bureauMatinStop || "";
        document.getElementById("trajetMatinStartTime").value = data.trajetMatinStart || "";
        document.getElementById("trajetMatinStopTime").value = data.trajetMatinStop || "";
        document.getElementById("pauseMidiStartTime").value = data.pauseMidiStart || "";
        document.getElementById("pauseMidiStopTime").value = data.pauseMidiStop || "";
        document.getElementById("trajetSoirStartTime").value = data.trajetSoirStart || "";
        document.getElementById("trajetSoirStopTime").value = data.trajetSoirStop || "";
        document.getElementById("bureauSoirStartTime").value = data.bureauSoirStart || "";
        document.getElementById("bureauSoirStopTime").value = data.bureauSoirStop || "";
        document.getElementById("resultTrajetMatin").querySelector("span").textContent =
          data.resultTrajetMatin || "-";
        document.getElementById("resultTrajetSoir").querySelector("span").textContent =
          data.resultTrajetSoir || "-";
        document.getElementById("resultTempsTravail").querySelector("span").textContent =
          data.resultTempsTravail || "-";
      } else {
        clearInputs();
      }
    }
  </script>
  <div style="margin-top: 4px; text-align: center;">
    <a href="https://stephanemed.github.io/PoliConf/" style="color: #87CEFA; text-decoration: none;">Politique de confidentialit√©</a>
  </div>
</div>
</body>
</html>
